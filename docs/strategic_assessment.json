{
  "contract": "strategic_assessment",
  "project": "beep_boop_bb8",
  "version": "2025.08.11-hotfix.1",
  "last_updated": "11-Aug-2025 16:05 Europe/London",
  "executive_summary": "Add-on now boots cleanly, holds foreground, and connects to MQTT with LWT/online. BLE path initializes and MAC resolves/bypasses as configured. STP2 acceptance is complete. STP4 transport is solid; remaining gap is HA Discovery parity and command→state roundtrip validation.",
  "current_status": {
    "stp1_container_ble": {
      "percent_complete": 95,
      "state": "green",
      "notes": "Bleak + BlueZ via system D-Bus; adapter hci0 healthy; rare cold-boot flake mitigated with retries.",
      "evidence_paths": [
        "/addons/local/beep_boop_bb8/logs/startup_latest.log"
      ]
    },
    "stp2_logging_health_security": {
      "percent_complete": 100,
      "state": "green",
      "attestations": ["STP2/no-secrets: PASS"],
      "evidence_paths": [
        "/addons/local/beep_boop_bb8/reports/bb8_health_endpoint_log.json"
      ]
    },
    "stp4_mqtt_ha_roundtrip": {
      "percent_complete": 75,
      "state": "amber",
      "notes": "MQTT connect stable (rc=0). Discovery payload parity and command→state echo (<2s) pending verification.",
      "evidence_paths": [
        "/addons/local/beep_boop_bb8/reports/ha_mqtt_trace_snapshot.json",
        "/addons/local/beep_boop_bb8/reports/ha_discovery_payloads.json"
      ]
    }
  },
  "recommendations": [
    "Finish Discovery parity: ensure published entities match README (presence, RSSI, power, stop, LED, etc.).",
    "Implement/verify command subscriptions and state echo within ≤2000 ms for every entity.",
    "Emit periodic telemetry (RSSI/presence) at 15–30 s; retain last-known states.",
    "Pin HA minor for acceptance (2025.8.x), then smoke test next minor before release.",
    "Keep AppArmor disabled until a tested profile is shipped; then enable with DBus/BLE allowances."
  ],
  "risk_register": [
    {
      "risk": "BLE adapter flakiness on cold boot",
      "probability": "medium",
      "impact": "medium",
      "mitigation": "Exponential backoff + adapter up checks; optional hci reset on repeated failure."
    },
    {
      "risk": "HA discovery schema drift vs docs",
      "probability": "medium",
      "impact": "medium",
      "mitigation": "Validate payloads against HA schema; align README or payloads."
    },
    {
      "risk": "Broker ACL/credential changes",
      "probability": "low",
      "impact": "medium",
      "mitigation": "Human-readable MQTT rc logging (done); document core-mosquitto + user/pass."
    }
  ],
  "milestones": [
    {"name": "M1 — STP2 audit", "date": "12-Aug-2025", "owner": "Evert Appels", "status": "on-track"},
    {"name": "M2 — STP4 roundtrip", "date": "14-Aug-2025", "owner": "Evert Appels", "status": "planned"},
    {"name": "M3 — Final regression & release", "date": "16-Aug-2025", "owner": "Evert Appels", "status": "planned"}
  ],
  "confidence_metrics": {
    "structural": 96,
    "operational": 93,
    "semantic": 95,
    "adoption": 92
  }
}
