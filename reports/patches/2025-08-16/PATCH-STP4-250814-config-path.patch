# Patch: Config Path Logging Clarity and Resolution Order
# Target: addon_config.py

from pathlib import Path
import os
import yaml
import logging

log = logging.getLogger(__name__)

# Define candidate search paths with HA-first priority
CANDIDATE_PATHS = [
    Path("/config/config.yaml"),
    Path("/addons/local/beep_boop_bb8/config.yaml"),
    Path(__file__).parent / "config.yaml",
    Path("/app/config.yaml"),
    Path("/Volumes/addons/local/beep_boop_bb8/config.yaml"),  # dev-only
]

loaded_config = None
source_path = None

for path in CANDIDATE_PATHS:
    if path.exists():
        try:
            with path.open("r") as f:
                loaded_config = yaml.safe_load(f)
            source_path = path
            log.info(f"[CONFIG] Loaded config from: {path}")
            break
        except Exception as e:
            log.warning(f"[CONFIG] Failed to load from {path}: {e}")
    else:
        if "Volumes" in str(path):
            log.debug(f"[CONFIG] Dev-only path skipped (not applicable in HA): {path}")
        else:
            log.debug(f"[CONFIG] Path not found: {path}")

if loaded_config is None:
    log.error("[CONFIG] No valid YAML config found in expected locations.")

---



The patch `PATCH-STP4-250814-config-path.patch` has been applied to `addon_config.py`. The config file search logic now:

- Uses a prioritized list of candidate paths (with Home Assistant standard paths first).
- Logs clearly which config file was loaded, or why each path was skipped.
- Improves error reporting and clarity for operational troubleshooting.

Let me know if you want to test, further refactor, or review the changes!
