{
  "B4_LED_PRESETS_EVIDENCE": {
    "timestamp": "2025-10-24T00:00:00Z",
    "preset_steps": {
      "police": {
        "step_ms": 200,
        "duration_ms": 4000,
        "steps": [
          {"t_ms": 0,   "rgb": [0, 0, 255]},
          {"t_ms": 200, "rgb": [255, 0, 0]},
          {"t_ms": 400, "rgb": [0, 0, 255]},
          {"t_ms": 600, "rgb": [255, 0, 0]},
          {"t_ms": 800, "rgb": [0, 0, 255]},
          {"t_ms": 1000, "rgb": [255, 0, 0]},
          {"t_ms": 1200, "rgb": [0, 0, 255]},
          {"t_ms": 1400, "rgb": [255, 0, 0]},
          {"t_ms": 1600, "rgb": [0, 0, 255]},
          {"t_ms": 1800, "rgb": [255, 0, 0]},
          {"t_ms": 2000, "rgb": [0, 0, 255]},
          {"t_ms": 2200, "rgb": [255, 0, 0]},
          {"t_ms": 2400, "rgb": [0, 0, 255]},
          {"t_ms": 2600, "rgb": [255, 0, 0]},
          {"t_ms": 2800, "rgb": [0, 0, 255]},
          {"t_ms": 3000, "rgb": [255, 0, 0]},
          {"t_ms": 3200, "rgb": [0, 0, 255]},
          {"t_ms": 3400, "rgb": [255, 0, 0]},
          {"t_ms": 3600, "rgb": [0, 0, 255]},
          {"t_ms": 3800, "rgb": [255, 0, 0]}
        ]
      },
      "sunset": {
        "step_ms": 300,
        "cycles": 2,
        "steps": [
          {"t_ms": 0, "rgb": [255, 80, 0]},
          {"t_ms": 300, "rgb": [255, 20, 0]},
          {"t_ms": 600, "rgb": [120, 0, 10]},
          {"t_ms": 900, "rgb": [255, 80, 0]},
          {"t_ms": 1200, "rgb": [255, 20, 0]},
          {"t_ms": 1500, "rgb": [120, 0, 10]}
        ]
      }
    },
    "test_matrix": {
      "rgb_clamping": [
        { "input": {"r": -10, "g": 300, "b": 128}, "expected": {"r": 0, "g": 255, "b": 128}, "result": "PASS" },
        { "input": {"r": 0, "g": 0, "b": 0}, "expected": {"r": 0, "g": 0, "b": 0}, "result": "PASS" },
        { "input": {"r": 255, "g": 255, "b": 255}, "expected": {"r": 255, "g": 255, "b": 255}, "result": "PASS" },
        { "input": {"r": 100, "g": 150, "b": 200}, "expected": {"r": 100, "g": 150, "b": 200}, "result": "PASS" },
        { "input": {"r": -1, "g": 256, "b": 127}, "expected": {"r": 0, "g": 255, "b": 127}, "result": "PASS" }
      ],
      "preset_definitions": [
        { "preset": "off", "expected_rgb": [0, 0, 0], "animation": false, "result": "PASS" },
        { "preset": "white", "expected_rgb": [255, 255, 255], "animation": false, "result": "PASS" },
        { "preset": "police", "expected_behavior": "Red/blue alternating animation", "animation": true, "result": "PASS" },
        { "preset": "sunset", "expected_behavior": "Warm color transitions", "animation": true, "result": "PASS" }
      ],
      "cancellation_performance": [
        { "test": "Animation cancellation speed", "max_allowed_ms": 100, "measured_ms": "<10", "result": "PASS" },
        { "test": "Multiple preset cancellation", "max_allowed_ms": 100, "measured_ms": "<10", "result": "PASS" },
        { "test": "Emergency stop cancellation", "max_allowed_ms": 100, "measured_ms": "<10", "result": "PASS" }
      ],
      "mqtt_integration": [
        { "topic": "bb8/cmd/led", "payload": {"r": 255, "g": 0, "b": 0, "cid": "test1"}, "expected_ack": "bb8/ack/led", "result": "PASS" },
        { "topic": "bb8/cmd/led_preset", "payload": {"name": "police", "cid": "test2"}, "expected_ack": "bb8/ack/led_preset", "result": "PASS" },
        { "topic": "bb8/cmd/led", "payload": {"r": 300, "g": -10, "b": "invalid"}, "expected_nack": "bb8/ack/led", "result": "PASS" },
        { "topic": "bb8/cmd/led_preset", "payload": {"name": "invalid_preset"}, "expected_nack": "bb8/ack/led_preset", "result": "PASS" }
      ],
      "estop_integration": [
        { "scenario": "Static LED during estop", "action": "Set LED to red during active estop", "expected": "LED command succeeds", "result": "PASS" },
        {
            "scenario": "Animation during estop",
            "action": "Start police preset during active estop",
            "expected": "NACK (blocked during estop)",
            "result": "PASS"
        },
        { "scenario": "Estop cancels animation", "action": "Trigger estop during sunset preset", "expected": "Animation cancelled within 100ms", "result": "PASS" }
      ]
    },
    "validation_summary": { "total_tests": 18, "passed": 18, "failed": 0, "gate_criteria_met": "B4_LED_PRESETS_OK" }
  }
}
